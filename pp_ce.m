%Principal program 

close all
clear
clc 

%==========================================================================
%Values of mobility and epidemiological parameters.
%==========================================================================

%alpha=[Dpr Dpu Dup Dur Drp Dru Opr Kpr Kpu Kup Kur Krp Kru Apr Apu Aup Aur Arp Aru];
alpha=1*[0.5 0.5 0.5 0.5 0.5 0.5 ...
       0.5 ...
       0.5 0.5 0.5 0.5 0.5 0.5 ... 
       0.5 0.5 0.5 0.5 0.5 0.5];

%delta=[Dr1 Du1 Dp1 Or1 Kr1 Ku1 Kp1 Ar1 Au1 Ap1];
delta=0.303*[1 1 1 ...
       1 ...
       1 1 1 ...
       1 1 1];

%tau=[Dr2 Du2 Dp2 Op2 Or2 Kr2 Ku2 Kp2 Ar2 Au2 Ap2 KA];
tau(1,1:11)=0.5;
tau(1,12)=0.0667;

%mu=[D1 O1 H1];
mu=[0.0800 0.0833 0.0141]; 

%d=[D2 O2 H2 Ki Ai];
d=[0.0800 0.0833 0.0125 0.1460 0.1460]; 

%beta=[DO OD KD AD];
beta=[0.0350 0.0860 0.0430 0.0323];%(2023, Chacha)

%gamma=[Dsi Oie Ksi Kie Asi Aie];
gamma=[0.2500 0.1090 0.500 0.0714 0.500 0.0714];


%==========================================================================
%Initial host values according to epidemiological stages and area.
%==========================================================================

%x=[DPS;DPI;NDP;DUS;DUI;NDU;DRS;DRI;NDR;...
%   OPS;OPE;OPI;NOP;ORS;ORE;ORI;NOR;...
%   KPS;KPE;KPI;KPD;NKP;KUS;KUE;KUI;KUD;NKU;KRS;KRE;KRI;KRD;NKR;...
%   APS;APE;API;APD;NAP;AUS;AUE;AUI;AUD;NAU;ARS;ARE;ARI;ARD;NAR];

% x0=[DPS0;DPI0;NDP0;...
%     DUS0;DUI0;NDU0;...
%     DRS0;DRI0;NDR0;...
%     OPS0;OPE0;OPI0;NOP0;...
%     ORS0;ORE0;ORI0;NOR0;...
%     KPS0;KPE0;KPI0;KPD0;NKP0;...
%     KUS0;KUE0;KUI0;KUD0;NKU0;...
%     KRS0;KRE0;KRI0;KRD0;NKR0;...
%     APS0;APE0;API0;APD0;NAP0;...
%     AUS0;AUE0;AUI0;AUD0;NAU0;...
%     ARS0;ARE0;ARI0;ARD0;NAR0];

x0=[500;20;520;...
    4000;50;4050;...
    1500;270;1770;...
    8680;247;347;9274;...
    70000;12600;12600;95200;...
    632;10;25;1;668;...
    25000;0;0;0;25000;...
    1500;5;270;1;1776;...
    632;10;25;1;668;...
    25000;0;0;0;25000;...
    1500;5;270;1;1776];


  echinococcosis=@(t,x,beta)[
     %Dogs peri-urban equations's
     (alpha(1)*delta(1)+tau(1))*x(7)+(alpha(2)*delta(2)+tau(2))*x(4)-(2*tau(3)+delta(3))*x(1)+...
     mu(1)*x(3)-(beta(1)*d(2)*(x(12)+x(16))/x(3)+d(1))*x(1)+gamma(1)*x(2);...
     (alpha(1)*delta(1)+tau(1))*x(8)+(alpha(2)*delta(2)+tau(2))*x(5)-(2*tau(3)+delta(3))*x(2)+...
     (beta(1)*d(2)*(x(12)+x(16))/x(3))*x(1)-d(1)*x(2)-gamma(1)*x(2);...
     0;...
     %Dogs urban equations's
     (alpha(3)*delta(3)+tau(3))*x(1)+(alpha(4)*delta(1)+tau(1))*x(7)-(2*tau(2)+delta(2))*x(4)+...
     mu(1)*x(6)-(beta(1)*d(2)*(x(12)+x(16))/x(6)+d(1))*x(4)+gamma(1)*x(5);...
     (alpha(3)*delta(3)+tau(3))*x(2)+(alpha(4)*delta(1)+tau(1))*x(8)-(2*tau(2)+delta(2))*x(5)+...
     (beta(1)*d(2)*(x(12)+x(16))/x(6))*x(4)-d(1)*x(5)-gamma(1)*x(5);...
     0;...
     %Dogs rural equations's
     (alpha(5)*delta(3)+tau(3))*x(1)+(alpha(6)*delta(2)+tau(2))*x(4)-(2*tau(1)+delta(1))*x(7)+...
     mu(1)*x(9)-(beta(1)*d(2)*(x(12)+x(16))/x(9)+d(1))*x(7)+gamma(1)*x(8);...
     (alpha(5)*delta(3)+tau(3))*x(2)+(alpha(6)*delta(2)+tau(2))*x(5)-(2*tau(1)+delta(1))*x(8)+...
     (beta(1)*d(2)*(x(12)+x(16))/x(9))*x(7)-d(1)*x(8)-gamma(1)*x(8);...
     0;...
     %Sheep peri-urban equations's
     alpha(7)*delta(4)*x(14)-tau(4)*x(10)+mu(2)*x(13)-(beta(2)*x(2)/x(13)+d(2))*x(10);...
     alpha(7)*delta(4)*x(15)-tau(4)*x(11)+beta(2)*x(2)*x(10)/x(13)-(gamma(2)+d(2))*x(11);...
     alpha(7)*delta(4)*x(16)-tau(4)*x(12)+gamma(2)*x(11)-d(2)*x(12);...
     0;...
     %Sheep rural equations's
     tau(4)*x(10)-alpha(7)*delta(4)*x(14)+mu(2)*x(17)-(beta(2)*x(8)/x(17)+d(2))*x(14);...
     tau(4)*x(11)-alpha(7)*delta(4)*x(15)+beta(2)*x(8)*x(14)/x(17)-(gamma(2)+d(2))*x(15);...
     tau(4)*x(12)-alpha(7)*delta(4)*x(16)+gamma(2)*x(15)-d(2)*x(16);...
     0;...
     %Children peri-urban equations's
     (alpha(8)*delta(5)+tau(6))*x(28)+(alpha(9)*delta(6)+tau(7))*x(23)-(2*tau(8)+delta(7))*x(18)+...
     mu(3)*x(22)-(beta(3)*x(2)/x(22)+tau(12))*x(18)+gamma(3)*x(20)-d(3)*x(18);...
     (alpha(8)*delta(5)+tau(6))*x(29)+(alpha(9)*delta(6)+tau(7))*x(24)-(2*tau(8)+delta(7))*x(19)+...
     beta(3)*x(2)*x(18)/x(22)-(gamma(4)+tau(12))*x(19)-d(3)*x(19);...
     (alpha(8)*delta(5)+tau(6))*x(30)+(alpha(9)*delta(6)+tau(7))*x(25)-(2*tau(8)+delta(7))*x(20)+...
     gamma(4)*x(19)-(d(4)+tau(12))*x(20)-gamma(3)*x(20)-d(3)*x(20);...
     (alpha(8)*delta(5)+tau(6))*x(31)+(alpha(9)*delta(6)+tau(7))*x(26)-(2*tau(8)+delta(7))*x(21)+...
     d(4)*x(20);...
     0;...
     %Children urban equations's
     (alpha(10)*delta(7)+tau(8))*x(18)+(alpha(11)*delta(5)+tau(6))*x(28)-(2*tau(7)+delta(6))*x(23)+...
     mu(3)*x(27)-(beta(3)*x(5)/x(27)+tau(12))*x(23)+gamma(3)*x(25)-d(3)*x(23);...
     (alpha(10)*delta(7)+tau(8))*x(19)+(alpha(11)*delta(5)+tau(6))*x(29)-(2*tau(7)+delta(6))*x(24)+...
     beta(3)*x(5)*x(23)/x(27)-(gamma(4)+tau(12))*x(24)-d(3)*x(24);...
     (alpha(10)*delta(7)+tau(8))*x(20)+(alpha(11)*delta(5)+tau(6))*x(30)-(2*tau(7)+delta(6))*x(25)+...
     gamma(4)*x(24)-(d(4)+tau(12))*x(25)-gamma(3)*x(25)-d(3)*x(25);...
     (alpha(10)*delta(7)+tau(8))*x(21)+(alpha(11)*delta(5)+tau(6))*x(31)-(2*tau(7)+delta(6))*x(26)+...
     d(4)*x(25);...
     0;...
     %Children rural equations's
     (alpha(12)*delta(7)+tau(8))*x(18)+(alpha(13)*delta(6)+tau(7))*x(23)-(2*tau(6)+delta(5))*x(28)+...
     mu(3)*x(32)-(beta(3)*x(8)/x(32)+tau(12))*x(28)+gamma(3)*x(30)-d(3)*x(28);...
     (alpha(12)*delta(7)+tau(8))*x(19)+(alpha(13)*delta(6)+tau(7))*x(24)-(2*tau(6)+delta(5))*x(29)+...
     beta(3)*x(8)*x(28)/x(32)-(gamma(4)+tau(12))*x(29)-d(3)*x(29);...
     (alpha(12)*delta(7)+tau(8))*x(20)+(alpha(13)*delta(6)+tau(7))*x(25)-(2*tau(6)+delta(5))*x(30)+...
     gamma(4)*x(29)-(d(4)+tau(12))*x(30)-gamma(3)*x(30)-d(3)*x(30);...
     (alpha(12)*delta(7)+tau(8))*x(21)+(alpha(13)*delta(6)+tau(7))*x(26)-(2*tau(6)+delta(5))*x(31)+...
     d(4)*x(30);...
     0;...
     %Adults peri-urban equations's
     (alpha(14)*delta(8)+tau(9))*x(43)+(alpha(15)*delta(9)+tau(10))*x(38)-(2*tau(11)+delta(10))*x(33)+...
     tau(12)*x(18)-(beta(4)*x(2)/x(37)+d(3))*x(33)+gamma(5)*x(35);...
     (alpha(14)*delta(8)+tau(9))*x(44)+(alpha(15)*delta(9)+tau(10))*x(39)-(2*tau(11)+delta(10))*x(34)+...
     beta(4)*x(2)*x(33)/x(37)+tau(12)*x(19)-(gamma(6)+d(3))*x(34);...
     (alpha(14)*delta(8)+tau(9))*x(45)+(alpha(15)*delta(9)+tau(10))*x(40)-(2*tau(11)+delta(10))*x(35)+...
     gamma(6)*x(34)+tau(12)*x(20)-(d(5)+d(3))*x(35)-gamma(5)*x(35);...
     (alpha(14)*delta(8)+tau(9))*x(46)+(alpha(15)*delta(9)+tau(10))*x(41)-(2*tau(11)+delta(10))*x(36)+...
     d(5)*x(35);...
     0;...
     %Adults urban equations's
     (alpha(16)*delta(10)+tau(11))*x(33)+(alpha(17)*delta(8)+tau(9))*x(43)-(2*tau(10)+delta(9))*x(38)+...
     tau(12)*x(23)-(beta(4)*x(5)/x(42)+d(3))*x(38)+gamma(5)*x(40);...
     (alpha(16)*delta(10)+tau(11))*x(34)+(alpha(17)*delta(8)+tau(9))*x(44)-(2*tau(10)+delta(9))*x(39)+...
     beta(4)*x(5)*x(38)/x(42)+tau(12)*x(24)-(gamma(6)+d(3))*x(39);...
     (alpha(16)*delta(10)+tau(11))*x(35)+(alpha(17)*delta(8)+tau(9))*x(45)-(2*tau(10)+delta(9))*x(40)+...
     gamma(6)*x(39)+tau(12)*x(25)-(d(5)+d(3))*x(40)-gamma(5)*x(40);...
     (alpha(16)*delta(10)+tau(11))*x(36)+(alpha(17)*delta(8)+tau(9))*x(46)-(2*tau(10)+delta(9))*x(41)+...
     d(5)*x(40);...
     0;...
     %Adults rural equations's
     (alpha(18)*delta(10)+tau(11))*x(33)+(alpha(19)*delta(9)+tau(10))*x(38)-(2*tau(9)+delta(8))*x(43)+...
     tau(12)*x(28)-(beta(4)*x(8)/x(47)+d(3))*x(43)+gamma(5)*x(45);...
     (alpha(18)*delta(10)+tau(11))*x(34)+(alpha(19)*delta(9)+tau(10))*x(39)-(2*tau(9)+delta(8))*x(44)+...
     beta(4)*x(8)*x(43)/x(47)+tau(12)*x(29)-(gamma(6)+d(3))*x(44);...
     (alpha(18)*delta(10)+tau(11))*x(35)+(alpha(19)*delta(9)+tau(10))*x(40)-(2*tau(9)+delta(8))*x(45)+...
     gamma(6)*x(44)+tau(12)*x(30)-(d(5)+d(3))*x(45)-gamma(5)*x(45);...
     (alpha(18)*delta(10)+tau(11))*x(36)+(alpha(19)*delta(9)+tau(10))*x(41)-(2*tau(9)+delta(8))*x(46)+...
     d(5)*x(45);...
     0];

%==========================================================================
%Numerical solutions 
%==========================================================================


timevect=0:0.1:20;


[t,x]=ode45(echinococcosis,timevect,x0,[],beta);








 